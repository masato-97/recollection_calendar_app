<div class="col mb-4">
  <div id="memory-id-<%= memory.id %>">
    <% if memory.main_image.present? %>
      <%= link_to image_tag(memory.main_image, class: "bd-placeholder-img rounded-top border-top border-end border-start", width: "100%", height: "245", xmlns: "http://www.w3.org/2000/svg", role: "img",  preserveAspectRatio: "xMidYMid slice", focusable: "false"), memory_path(memory) %>
    <% else %>
      <%= link_to image_tag("no_image.png", class: "bd-placeholder-img rounded-top border-top border-end border-start", width: "100%", height: "245", xmlns: "http://www.w3.org/2000/svg", role: "img",  preserveAspectRatio: "xMidYMid slice", focusable: "false"), memory_path(memory) %>
    <% end %>

    <div class="g-0 rounded-bottom border-end border-start shadow-sm overflow-hidden flex-md-row h-md-250 position-relative memory-coloe memory-style">
      <div class="col memory-p d-flex flex-column position-static">
        <div class="title-wrapper">
          <h4 class="mb-1 border-bottom title-limit">
            <%= memory.title %>
          </h4>
        </div>

        <% if memory.score.present? %>
          <div class="content average-score mb-1">
            <div class="star-rating mb-2">
              <div class="star-rating-front" style="width: <%= memory.score * 20 %>%">★★★★★</div>
              <div class="star-rating-back">★★★★★</div>
            </div>
            <div class="average-score-display ml-3 pt-2">
              <%= memory.score %>/5
            </div>
          </div>
        <% end %>

        <p class="card-text mb-1 mt-1 body-limit">
          <%= safe_join(memory.body.split("\n"),tag(:br)) %>
        </p>

        <% if memory.tags.present? %>
          <div class="tag-container mt-1">
            <% memory.tags.first(3).each do |tag| %>
              <div class="tag">
                <i class="bi bi-tag-fill"></i>
                <%= tag.name.truncate(8, omission: '') %>
              </div>
            <% end %>
            <% if memory.tags.size > 3 %>
              ...
            <% end %>
          </div>
        <% else %>
          <br>
        <% end %>

        <div class="day-link-inner mt-1">
          <div class="text-body-secondary">
            <%= memory.day.strftime("%Y/%m/%d") %>
          </div>
          <a href="/memories/<%= memory.id %>" class="icon-link gap-1 icon-link-hover stretched-link">
            思い出詳細
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-right" viewBox="0 0 16 16">
              <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708"/>
            </svg>
          </a>
        </div>
      </div>
    </div>
  </div>
</div>